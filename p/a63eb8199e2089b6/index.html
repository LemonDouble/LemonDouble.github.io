<!doctype html><html lang=ko dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="1. Forward Auth? 인증 로직이 필요할 떄, 우리는 인증 로직을 어디서 구현할 수 있을까요?\n바로 드는 생각은, 어플리케이션에서 직접 구현하는 방법일 것입니다.\n하지만 어플리케이션이 많아지면 어떨까요? 혹은, 일부 어플리케이션은 내가 만든 것이 아니라 다른 사람이 만든 어플리케이션이라, 내가 맘대로 인증 로직을 구현할 수 없다면 어떨까요?\n"><title>집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 10-2. Forward Auth와 OAuth2를 이용한 SSO 구현</title>
<link rel=canonical href=https://blog.lemondouble.com/p/a63eb8199e2089b6/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 10-2. Forward Auth와 OAuth2를 이용한 SSO 구현"><meta property='og:description' content="1. Forward Auth? 인증 로직이 필요할 떄, 우리는 인증 로직을 어디서 구현할 수 있을까요?\n바로 드는 생각은, 어플리케이션에서 직접 구현하는 방법일 것입니다.\n하지만 어플리케이션이 많아지면 어떨까요? 혹은, 일부 어플리케이션은 내가 만든 것이 아니라 다른 사람이 만든 어플리케이션이라, 내가 맘대로 인증 로직을 구현할 수 없다면 어떨까요?\n"><meta property='og:url' content='https://blog.lemondouble.com/p/a63eb8199e2089b6/'><meta property='og:site_name' content='Lemon Blog'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='K8S'><meta property='article:tag' content='K3S'><meta property='article:tag' content='라즈베리 파이'><meta property='article:published_time' content='2024-01-07T16:05:04+09:00'><meta property='article:modified_time' content='2024-01-07T16:05:04+09:00'><meta property='og:image' content='https://blog.lemondouble.com/p/a63eb8199e2089b6/cover.png'><meta name=twitter:site content="@https://blog.lemondouble.com"><meta name=twitter:creator content="@https://blog.lemondouble.com"><meta name=twitter:title content="집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 10-2. Forward Auth와 OAuth2를 이용한 SSO 구현"><meta name=twitter:description content="1. Forward Auth? 인증 로직이 필요할 떄, 우리는 인증 로직을 어디서 구현할 수 있을까요?\n바로 드는 생각은, 어플리케이션에서 직접 구현하는 방법일 것입니다.\n하지만 어플리케이션이 많아지면 어떨까요? 혹은, 일부 어플리케이션은 내가 만든 것이 아니라 다른 사람이 만든 어플리케이션이라, 내가 맘대로 인증 로직을 구현할 수 없다면 어떨까요?\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://blog.lemondouble.com/p/a63eb8199e2089b6/cover.png'><link rel="shortcut icon" href=https://cdn.lemondouble.com/homepage/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-9C6YX68EBM"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9C6YX68EBM")</script><style>@import "https://cdnjs.cloudflare.com/ajax/libs/pretendard/1.3.9/static/pretendard.min.css";@import 'https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,500;1,500&display=swap';*{font-family:-apple-system,BlinkMacSystemFont,apple sd gothic neo,pretendard variable,Pretendard,Roboto,noto sans kr,segoe ui,malgun gothic,apple color emoji,segoe ui emoji,segoe ui symbol,sans-serif}</style></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="메뉴 여닫기">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_3c50f63a05989f65.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>⛱️</span></figure><div class=site-meta><h1 class=site-name><a href=/>Lemon Blog</a></h1><h2 class=site-description>이런저런 걸 합니다. 블로그 기고는 보통 제가 했던 일을 까먹지 않기 위해 합니다(..)</h2></div></header><ol class=menu-social><li><a href=https://github.com/LemonDouble target=_blank title=GitHub rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" class="icon icon-tabler icons-tabler-filled icon-tabler-brand-github"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5.315 2.1c.791-.113 1.9.145 3.333.966l.272.161.16.1.397-.083a13.3 13.3.0 014.59-.08l.456.08.396.083.161-.1c1.385-.84 2.487-1.17 3.322-1.148l.164.008.147.017.076.014.05.011.144.047a1 1 0 01.53.514 5.2 5.2.0 01.397 2.91l-.047.267-.046.196.123.163c.574.795.93 1.728 1.03 2.707l.023.295L21 9.5c0 3.855-1.659 5.883-4.644 6.68l-.245.061-.132.029.014.161.008.157.004.365-.002.213L16 21a1 1 0 01-.883.993L15 22H9a1 1 0 01-.993-.883L8 21v-.734c-1.818.26-3.03-.424-4.11-1.878l-.535-.766c-.28-.396-.455-.579-.589-.644l-.048-.019a1 1 0 01.564-1.918c.642.188 1.074.568 1.57 1.239l.538.769c.76 1.079 1.36 1.459 2.609 1.191L8 17.562l-.018-.168a5.03 5.03.0 01-.021-.824l.017-.185.019-.12-.108-.024c-2.976-.71-4.703-2.573-4.875-6.139l-.01-.31-.004-.292a5.6 5.6.0 01.908-3.051l.152-.222.122-.163-.045-.196a5.2 5.2.0 01.145-2.642l.1-.282.106-.253a1 1 0 01.529-.514l.144-.047.154-.03z"/></svg></a></li><li><a href=mailto:contact@lemondouble.com target=_blank title=mail rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" class="icon icon-tabler icons-tabler-filled icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 7.535V17a3 3 0 01-2.824 2.995L19 20H5a3 3 0 01-2.995-2.824L2 17V7.535l9.445 6.297.116.066a1 1 0 00.878.0l.116-.066 9.445-6.297z"/><path d="M19 4c1.08.0 2.027.57 2.555 1.427L12 11.797l-9.555-6.37a2.999 2.999.0 012.354-1.42L5 4h14z"/></svg></a></li><li><a href=https://sns.lemondouble.com/@lemondouble target=_blank title=misskey rel=me><svg class="bi" fill="currentcolor" viewBox="0 0 135.47 135.47"><g transform="translate(-38.1 -100.7)"><path d="m54.63 120.96c-1.9779.0-3.8618.32979-5.6513.98909-3.2023 1.1302-5.8396 3.1553-7.9117 6.0751-1.9779 2.8256-2.9667 5.9807-2.9667 9.4656v61.88c0 4.5209 1.601 8.4294 4.8033 11.726 3.2965 3.2023 7.2055 4.8038 11.726 4.8038 4.6151.0 8.5236-1.6015 11.726-4.8038 3.2965-3.2965 4.9449-7.205 4.9449-11.726v-11.253c.03556-2.4371 2.546-1.7977 3.8148.0 2.3763 4.1153 7.4142 7.6497 13.28 7.6295 5.8656-.0202 10.737-2.9202 13.28-7.6295.96304-1.1358 3.6774-3.071 3.9558.0v11.253c0 4.5209 1.601 8.4294 4.8033 11.726 3.2965 3.2023 7.2055 4.8038 11.726 4.8038 4.6151.0 8.5236-1.6015 11.726-4.8038 3.2965-3.2965 4.9449-7.205 4.9449-11.726v-61.88c0-3.4849-1.0357-6.64-3.1078-9.4656-1.9779-2.9198-4.5683-4.9448-7.7706-6.0751-1.8837-.6593-3.7676-.98909-5.6513-.98909-5.086.0-9.3712 1.9782-12.856 5.934l-16.775 19.632c-.37674.28256-1.6248 2.4428-4.2757 2.4428s-3.7574-2.1602-4.1341-2.4428l-16.916-19.632c-3.3907-3.9558-7.6289-5.934-12.715-5.934zm104.53.0c-3.9558.0-7.3464 1.4129-10.172 4.2385-2.7314 2.7314-4.0969 6.0751-4.0969 10.031.0 3.9558 1.3655 7.3464 4.0969 10.172 2.8256 2.7314 6.2162 4.0974 10.172 4.0974s7.3464-1.366 10.172-4.0974c2.8256-2.8256 4.2385-6.2162 4.2385-10.172s-1.4129-7.2995-4.2385-10.031c-2.8256-2.8256-6.2162-4.2385-10.172-4.2385zm.14107 31.364c-3.9558.0-7.3464 1.4129-10.172 4.2385s-4.238 6.2162-4.238 10.172v34.896c0 3.9558 1.4124 7.3464 4.238 10.172 2.8256 2.7314 6.2162 4.0974 10.172 4.0974s7.2995-1.366 10.031-4.0974c2.8256-2.8256 4.2385-6.2162 4.2385-10.172v-34.896c0-3.9558-1.4129-7.3464-4.2385-10.172-2.7314-2.8256-6.0751-4.2385-10.031-4.2385z"/></g></svg></a></li><li><a href=https://twitter.com/_lemon_berry_ target=_blank title=Twitter rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" class="icon icon-tabler icons-tabler-filled icon-tabler-brand-twitter"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14.058 3.41c-1.807.767-2.995 2.453-3.056 4.38L11 7.972l-.243-.023C8.365 7.68 6.259 6.437 4.813 4.418a1 1 0 00-1.685.092l-.097.186-.049.099c-.719 1.485-1.19 3.29-1.017 5.203l.03.273c.283 2.263 1.5 4.215 3.779 5.679l.173.107-.081.043c-1.315.663-2.518.952-3.827.9-1.056-.04-1.446 1.372-.518 1.878 3.598 1.961 7.461 2.566 10.792 1.6 4.06-1.18 7.152-4.223 8.335-8.433l.127-.495c.238-.993.372-2.006.401-3.024l.003-.332.393-.779.44-.862.214-.434.118-.247c.265-.565.456-1.033.574-1.43l.014-.056.008-.018c.22-.593-.166-1.358-.941-1.358l-.122.007a.997.997.0 00-.231.057l-.086.038a7.46 7.46.0 01-.88.36l-.356.115-.271.08-.772.214c-1.336-1.118-3.144-1.254-5.012-.554l-.211.084z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>홈</span></a></li><li><a href=/about/ target=_blank><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>프로필 (🔗)</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>보관함</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>검색</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>다크 모드</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">목차</h2><div class=widget--toc><nav id=TableOfContents><ol><li><ol><li><a href=#1-forward-auth>1. Forward Auth?</a></li><li><a href=#2-oauth2와-cookie-forward-auth>2. OAuth2와 Cookie, Forward Auth</a><ol><li><a href=#2-1-가장-간단한-forward-auth-서버>2-1. 가장 간단한 Forward Auth 서버</a></li><li><a href=#2-2-인증-토큰은-어디에-저장하지>2-2. 인증 토큰은 어디에 저장하지?</a></li><li><a href=#2-3-jwt-토큰-사용-및-만료-설정-유효성-검증>2-3. JWT 토큰 사용 및 만료 설정, 유효성 검증</a></li><li><a href=#2-4-리다이렉트-처리>2-4. 리다이렉트 처리</a></li><li><a href=#2-5-oauth-시작>2-5. OAuth 시작!</a></li><li><a href=#2-6-oauth-전체-플로우>2-6. OAuth 전체 플로우</a></li><li><a href=#2-7-추가-설정>2-7. 추가 설정</a></li></ol></li><li><a href=#마치며>마치며</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/a63eb8199e2089b6/><img src=/p/a63eb8199e2089b6/cover_hu_1be03112d9502320.png srcset="/p/a63eb8199e2089b6/cover_hu_1be03112d9502320.png 800w, /p/a63eb8199e2089b6/cover_hu_c06389ceec5da93.png 1600w" width=800 height=249 loading=lazy alt="Featured image of post 집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 10-2. Forward Auth와 OAuth2를 이용한 SSO 구현"></a></div><div class=article-details><header class=article-category><a href=/categories/k8s/>K8S
</a><a href=/categories/k3s/>K3S
</a><a href=/categories/%EB%9D%BC%EC%A6%88%EB%B2%A0%EB%A6%AC-%ED%8C%8C%EC%9D%B4/>라즈베리 파이</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/a63eb8199e2089b6/>집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 10-2. Forward Auth와 OAuth2를 이용한 SSO 구현</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2024년 1월 07일</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>7 분 정도</time></div></footer></div></header><section class=article-content><h3 id=1-forward-auth>1. Forward Auth?</h3><p>인증 로직이 필요할 떄, 우리는 인증 로직을 어디서 구현할 수 있을까요?</p><p>바로 드는 생각은, 어플리케이션에서 직접 구현하는 방법일 것입니다.</p><p>하지만 어플리케이션이 많아지면 어떨까요? 혹은, 일부 어플리케이션은 내가 만든 것이 아니라 다른 사람이 만든 어플리케이션이라, 내가 맘대로 인증 로직을 구현할 수 없다면 어떨까요?</p><p>우리는 쿠버네티스를 사용하고 있고, 모든 요청은 Traefik을 한번 거쳐갑니다.</p><p>따라서, Traefik이 <code>"요청을 전달하기 전"</code> 에 인증 로직을 처리하면 어떨까요?</p><p><img src=/p/a63eb8199e2089b6/image.png width=2420 height=639 srcset="/p/a63eb8199e2089b6/image_hu_4549db78960c5f1a.png 480w, /p/a63eb8199e2089b6/image_hu_eebf8230a6773b74.png 1024w" loading=lazy alt="Traefik forward Auth 그림" class=gallery-image data-flex-grow=378 data-flex-basis=908px></p><p><strong>간단합니다!</strong></p><ol><li>모든 요청은 Traefik을 지나갑니다.</li><li>만약 Forward Auth가 설정되어 있다면, 외부 인증 서비스에 요청을 보냅니다.</li><li>외부 인증 서비스는 다음과 같은 작업을 합니다.<ul><li>만약 유효한 요청이라면, 2XX대의 OK 코드를 보냅니다. 이 경우 정상적으로</li><li>만약 유효하지 않은 요청이라면 인증 서버의 응답을 그대로 반환합니다. (에러 반환)</li></ul></li></ol><p>그럼 이걸 어떻게 쓸 수 있을까요?</p><h3 id=2-oauth2와-cookie-forward-auth>2. OAuth2와 Cookie, Forward Auth</h3><h4 id=2-1-가장-간단한-forward-auth-서버>2-1. 가장 간단한 Forward Auth 서버</h4><p>처음부터 천천히 생각해 봅시다.</p><p>일단, 가장 간단한 Forward Auth 서버를 생각해 봅시다.</p><p>어떤 요청에 대해서는 OK, 어떤 요청에 대해서는 NO를 주려면 어떻게 해야 할까요?</p><p>맞습니다! 우리가 Basic Auth때 한번 본 적이 있듯, 각 요청에 대해 인증 정보를 같이 보내고, 그 인증 정보가 유효한 경우 통과시켜주면 될 것입니다.</p><p>그림으로 그려보면, 가장 간단한 예시는 다음과 같습니다.</p><p><img src=/p/a63eb8199e2089b6/image-1.png width=1200 height=1005 srcset="/p/a63eb8199e2089b6/image-1_hu_47ddd7e46937dd56.png 480w, /p/a63eb8199e2089b6/image-1_hu_a3cc726a6162690a.png 1024w" loading=lazy alt="가장 간단한 Forward Auth" class=gallery-image data-flex-grow=119 data-flex-basis=286px></p><h4 id=2-2-인증-토큰은-어디에-저장하지>2-2. 인증 토큰은 어디에 저장하지?</h4><p>좋습니다!</p><p>일단 가장 간단한 Forward Auth Server를 생각해 보았습니다. 그러면 다음은, &ldquo;그러면 토큰은 언제, 어디서 받아야 하는데?&rdquo; 라는 질문이 남습니다.</p><p>간단한 방법으론, 로그인 페이지를 하나 만들어서 로그인에 성공하면 Token을 발급해주는 방법이 있을 것 같습니다.</p><p>그림으로 그려보겠습니다.</p><p><img src=/p/a63eb8199e2089b6/image-2.png width=1791 height=1005 srcset="/p/a63eb8199e2089b6/image-2_hu_bdb98473ee1760d5.png 480w, /p/a63eb8199e2089b6/image-2_hu_29c0ba2a0836091e.png 1024w" loading=lazy alt="로그인 페이지 추가" class=gallery-image data-flex-grow=178 data-flex-basis=427px></p><p>어? 그런데 <code>auth.lemondouble.com</code> 에서 로그인했다면, 토큰을 어떻게 공유할 수 있을까요? 어디에 토큰을 저장해야 할까요?</p><p>그런데 나는 a.lemondouble.com, b.lemondouble.com같은 다른 사이트에서도 해당 토큰을 이용해서 로그인을 유지해야 합니다.</p><p>(사실 꽤 자주 있는 일이긴 하지만) a.lemondouble.com에서 이미 SSO 로그인을 했는데, b.lemondouble.com에서 로그인을 다시 시킨다면, (유저 정보가 공유되더라도) 너무 귀찮은 일일 것입니다!</p><p>우리는 이를 해결하기 위해서, Cookie에 토큰을 담을 예정입니다.</p><p>예를 들어, <code>.lemondouble.com</code> 에다가 Cookie를 설정하면, 해당 Cookie는 모든 서브도메인, 즉 <code>a.lemondouble.com</code> , <code>auth.lemondouble.com</code>, <code>'b.lemondouble.com'</code> 에 접속할 시 자동으로 같이 전송된다는 점을 이용하는 것입니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>res</span><span class=p>.</span><span class=nx>cookie</span><span class=p>(</span><span class=s1>&#39;forward-auth-token&#39;</span><span class=p>,</span> <span class=nx>token</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>domain</span><span class=o>:</span> <span class=s1>&#39;.lemondouble.com&#39;</span><span class=p>,</span>        <span class=c1>//subdomain까지 공유하려면 앞에 &#34;.&#34;을 붙여줘야함!
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>그러면, 많은 일이 간단해집니다! 정리해보죠.</p><ol><li>Forward Auth는 토큰이 있다면 허용, 토큰이 없다면 거부한다.</li><li>로그인 페이지를 만들어, 로그인 페이지는 로그인 성공시 <code>.lemondouble.com</code> 에 쿠키를 설정하도록 합니다.</li></ol><p>여기까지 정리해보면 다음과 같은 그림이 나옵니다.</p><p><img src=/p/a63eb8199e2089b6/image-3.png width=1791 height=1005 srcset="/p/a63eb8199e2089b6/image-3_hu_484549cb0de0ceb3.png 480w, /p/a63eb8199e2089b6/image-3_hu_a8977a718bd87cfb.png 1024w" loading=lazy alt="로그인 이후 쿠키 저장까지 그림" class=gallery-image data-flex-grow=178 data-flex-basis=427px></p><h4 id=2-3-jwt-토큰-사용-및-만료-설정-유효성-검증>2-3. JWT 토큰 사용 및 만료 설정, 유효성 검증</h4><p>자! 그런데 토큰 안에는 어떤 값이 들어가면 좋을까요?</p><p>이 경우, JWT가 적절할 것으로 보입니다. Stateless해야 하고, 위변조가 아주 어려운 토큰이야 말로 이 사용사례에 아주 적합해 보입니다.</p><p>안의 내용은.. 유저 ID나 이메일 정도가 좋겠네요.</p><p>그런데 토큰을 한번 발급했으면 천년만년 써도 될까요&mldr;? 그러면 토큰을 한번 탈취당하면 천년 만년 서버가 털리겠죠..? 따라서, 토큰 유효 기간 설정이 필요할 것 같습니다. 보안과 편의성 사이에 고려하면 될 것 같은데, 저는 편의상 3600초 (1시간) 을 사용한다고 가정해 보겠습니다.</p><p>그러면</p><ol><li>JWT를 Exp (Expired Time)을 현재시간 + 3600초로 로그인 서버에서 발급해 줘야 할 것 같네요. 편의상, Cookie 유지 시간도 3600초로 통일하면 좋겠네요.</li><li>Forward Auth에서 기존은 토큰이 있다면 무조건 통과였지만, 토큰 JWT 검증 및, 만료 토큰일 시 값이 유효하더라도 거절하는 로직을 추가해야 할 것 같습니다.</li></ol><p>그림으로 다시 그려보겠습니다.</p><p><img src=/p/a63eb8199e2089b6/image-4.png width=1791 height=1005 srcset="/p/a63eb8199e2089b6/image-4_hu_f8167bcf545e57fe.png 480w, /p/a63eb8199e2089b6/image-4_hu_e2c553dc3a6c119c.png 1024w" loading=lazy alt="JWT 토큰과 만료 추가" class=gallery-image data-flex-grow=178 data-flex-basis=427px></p><h4 id=2-4-리다이렉트-처리>2-4. 리다이렉트 처리</h4><p>그런데 만약 토큰이 유효하지 않거나, 토큰이 없다면 그냥 에러 페이지만 보여줘도 괜찮을까요?</p><p>물론&mldr; 내가 혼자 쓰면 안 될거 뭐 있겠습니까마는&mldr; 굉장히 매번 귀찮을 것입니다. 그냥 인증 실패하면 자동으로 로그인 페이지로 리다이렉트 시켜주면 편할 것 같네요.</p><p>바로 추가해 봅시다.</p><p><img src=/p/a63eb8199e2089b6/image-5.png width=1791 height=1005 srcset="/p/a63eb8199e2089b6/image-5_hu_38a5231d95f2f955.png 480w, /p/a63eb8199e2089b6/image-5_hu_31bfb85f4d9ae303.png 1024w" loading=lazy alt="리다이렉트 추가" class=gallery-image data-flex-grow=178 data-flex-basis=427px></p><p>그런데 보통 SSO 성공하면 기존 사이트로 돌아가잖아요? 그것도 한번 추가해 봅시다.</p><p>쿼리 파라미터나 헤더 등으로 &ldquo;원래 어디서 왔는지"를 기억하고, 로그인에 성공하면 원래 어디서 왔는지 기억해서 로그인 서버가 리다이렉트 처리를 해 주면 될 것 같습니다.</p><p><img src=/p/a63eb8199e2089b6/image-6.png width=1791 height=1005 srcset="/p/a63eb8199e2089b6/image-6_hu_da59f5765128a134.png 480w, /p/a63eb8199e2089b6/image-6_hu_aadf5e9ca425c0f8.png 1024w" loading=lazy alt="원래 사이트로 돌아가기" class=gallery-image data-flex-grow=178 data-flex-basis=427px></p><p>아.. OAuth는 이야기도 안 꺼냈는데 벌써 복잡하네요. 일단 한번 더 해 봅시다..</p><p>만약 통합인증이 ID/Password 로그인이라면 여기서 완성입니다. 여기서 조금 헷갈릴 수 있어서 정리하고 가면, 로그인 서버와 Traeifk의 Forward Auth 서버는 동일해도 무방합니다.</p><p>굳이 그림까지 그리면서 이걸 다시 쓰는 이유는, Forward Auth 인증 서버와 로그인 서버를 분리할 필요가 없어서입니다!</p><p><img src=/p/a63eb8199e2089b6/image-7.png width=1292 height=730 srcset="/p/a63eb8199e2089b6/image-7_hu_c79449495156ba32.png 480w, /p/a63eb8199e2089b6/image-7_hu_29737db47c31b538.png 1024w" loading=lazy alt="실패시 플로우를 다시 정리한 그림" class=gallery-image data-flex-grow=176 data-flex-basis=424px></p><h4 id=2-5-oauth-시작>2-5. OAuth 시작!</h4><p>일단 스펙을 정하고 가 봅시다.</p><p>저희가 만들 스펙은 다음과 같습니다.</p><ol><li>만약 어떤 서비스에 접근했는데, OAuth SSO가 필요하다면 바로 해당 Social Provider의 로그인 페이지로 이동합니다. (즉, 우리는 로그인 페이지를 만들지 않습니다!)</li><li>로그인에 성공하면 원래 접근하려는 서비스로 리다이렉트됩니다!</li></ol><p>그리고 Client ID 등록 등의 기본내용들은 생략합니다. 이걸 하나하나 설명하면 책 한 권이 나와서요.. 만약 OAuth 2.0 프로토콜에 대해 잘 모르신다면, 생활코딩의 <a class=link href=https://opentutorials.org/course/3405 target=_blank rel=noopener>Web2 - OAuth 2.0</a> 강의를 추천드릴게요. (공짭니다!)</p><h4 id=2-6-oauth-전체-플로우>2-6. OAuth 전체 플로우</h4><p>제가.. 진짜 이걸 쉽게 설명하려고 노력해봤는데&mldr; 솔직히 답이 안 서서요..</p><p>전체 플로우를 보여드리곘습니다.</p><p><img src=/p/a63eb8199e2089b6/image-8.png width=2013 height=1092 srcset="/p/a63eb8199e2089b6/image-8_hu_4261ade3f0ace299.png 480w, /p/a63eb8199e2089b6/image-8_hu_df0ff7956bdb6d4f.png 1024w" loading=lazy alt="OAuth SSO 전체 플로우" class=gallery-image data-flex-grow=184 data-flex-basis=442px></p><p>핵심 아이디어는 State Code를 이용하는 것입니다!</p><ul><li>OAuth 인증 서버에 요청을 보낼 때, 임의의 문자열을 생성해 같이 (?state=임의의문자열) 보내면, 이후 유저가 로그인 성공 후 돌아올 때 해당 문자열을 같이 보내주는 스펙이 OAuth 2.0 표준에 있습니다. (필수 파라미터는 아니라, OAuth 연동을 하면서 못 보셨을 수도 있습니다!)</li><li>이를 이용해서 유저가 &ldquo;어디서 왔는지&rdquo; 를 데이터베이스에 기록하고, 로그인 성공 후 해당 URL로 리다이렉트 시켜주는 아이디어를 차용합니다.</li></ul><p>전체 플로우는 위 그림을 참고해 주시고, 그러면 우리 인증 서버는 무엇을 구현해야 할까요?</p><p>엔드포인트 단 하나를 구현하는데, 다음을 구현하시면 됩니다. (위에서 순서대로 처리해야 합니다. 처리 순서가 중요합니다!)</p><ol><li><p>쿼리 파라미터로 code와 state가 있는 경우, State Code가 DB에 저장된 값과 일치하는지 확인합니다. 만약 DB에 해당 State Code가 존재한다면, 타사 OAuth Server과 통신하여 Authorization Code를 유저 정보로 변환합니다. 변환한 유저 정보가 미리 등록된 권한 리스트에 있는지 확인하고, 만약 없다면 오류를 반환합니다. 만약 권한 리스트에 있다면, 로그인용 신규 JWT를 생성 후 Cookie에 <code>.yourdomain.com</code> 으로 저장합니다. 이 때, 보안을 위해 secure, httpOnly 설정을 켜 주면 좋습니다. 또한 sameSite 옵션은 <code>'Lax'</code>로 설정합니다. 이후 State Code와 한 쌍인 URI로 유저를 Redirect 시킵니다.</p></li><li><p>Cookie에 JWT 토큰이 있는 경우, JWT 검증 후 정상 JWT라면 200을 반환합니다.</p></li><li><p>만약 Cookie에 JWT 토큰이 아예 없거나, 만료된 Cookie라면 만료된 Cookie를 지우고, State Code에 <code>X-Forwarded-Host</code> 헤더와 <code>X-Forwarded-Uri</code>를 파싱하여 현재 URI를 추출합니다. 이후 신규 State Code와 해당 URI 페어를 DB에 저장하고, 현재 API를 Redirect URL로 설정해 State Code와 함께 전송합니다.</p></li></ol><ul><li>TIP : 유저가 요청한 URI : <code>https://" + GetHeader("X-Forwarded-Host") + GetHeader("X-Forwarded-Uri")</code></li></ul><h4 id=2-7-추가-설정>2-7. 추가 설정</h4><p>마지막으로.. Traefik 설정에 다음 두 줄을 추가합니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>- &#34;--entryPoints.web.forwardedHeaders.insecure&#34;
</span></span><span class=line><span class=cl>- &#34;--entryPoints.websecure.forwardedHeaders.insecure&#34;
</span></span></code></pre></td></tr></table></div></div><p>해당 줄이 없으면, X-forwared-for 헤더들이 넘어오지 않습니다!</p><p>제 블로그의 글 (<a class=link href=https://lemondouble.github.io/p/%EC%A7%91%EC%97%90%EC%84%9C-%EB%9D%BC%EC%A6%88%EB%B2%A0%EB%A6%AC-%ED%8C%8C%EC%9D%B4-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0%EB%A1%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%84%BC%ED%84%B0-%EC%B0%A8%EB%A6%AC%EA%B8%B0-4.-traefik-https-%EC%9D%B8%EC%A6%9D-%EB%B0%8F-argocd-%EC%84%A4%EC%A0%95/ target=_blank rel=noopener>4. Traefik https 인증 및 ArgoCD 설정</a>) 을 참고하셨다면, 다음과 같이 설정하시면 됩니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># https://traefik.io/blog/https-on-kubernetes-using-traefik-proxy/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>helm.cattle.io/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>HelmChartConfig</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>traefik</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>kube-system</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>valuesContent</span><span class=p>:</span><span class=w> </span><span class=p>|-</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>    ports:
</span></span></span><span class=line><span class=cl><span class=sd>      web:
</span></span></span><span class=line><span class=cl><span class=sd>        redirectTo:
</span></span></span><span class=line><span class=cl><span class=sd>          port: websecure
</span></span></span><span class=line><span class=cl><span class=sd>          priority: 10
</span></span></span><span class=line><span class=cl><span class=sd>    additionalArguments:
</span></span></span><span class=line><span class=cl><span class=sd>      - &#34;--log.level=INFO&#34;
</span></span></span><span class=line><span class=cl><span class=sd>      - &#34;--certificatesresolvers.le.acme.email=yourMail@gmail.com&#34;
</span></span></span><span class=line><span class=cl><span class=sd>      - &#34;--certificatesresolvers.le.acme.storage=/data/acme.json&#34;
</span></span></span><span class=line><span class=cl><span class=sd>      - &#34;--certificatesresolvers.le.acme.tlschallenge=true&#34;
</span></span></span><span class=line><span class=cl><span class=sd>      - &#34;--certificatesresolvers.le.acme.caServer=https://acme-v02.api.letsencrypt.org/directory&#34;
</span></span></span><span class=line><span class=cl><span class=sd>      - &#34;--entryPoints.web.forwardedHeaders.insecure&#34;
</span></span></span><span class=line><span class=cl><span class=sd>      - &#34;--entryPoints.websecure.forwardedHeaders.insecure&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>이후 kubectl apply를 실행하여, Forwared Auth 설정을 마무리 해 줍시다.!</p><h3 id=마치며>마치며</h3><p>사실 내용이 너무 방대해서.. 가능한 쉽게 쓴다고 노력했는데, 제대로 전달은 안 되었을 것 같습니다. 나중에 글을 한번 수정해야 되지 않나 싶네요.</p><p>그래도 혹시 모르니, 참고하여 구축하실 분들은 이해 안 되는 부분이 있다면 아래 댓글이나, <a class=link href=mailto:contact@lemondouble.com>contact@lemondouble.com</a> 으로 편하게 연락 주세요! 트러블슈팅까지 같이 도와드리겠습니다.</p><p>아 그리고 혹시 Golang을 할줄 아신다면, <a class=link href=https://github.com/thomseddon/traefik-forward-auth target=_blank rel=noopener>traefik-forward-auth</a> 를 참고하셔도 좋습니다.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/k8s/>K8S</a>
<a href=/tags/k3s/>K3S</a>
<a href=/tags/%EB%9D%BC%EC%A6%88%EB%B2%A0%EB%A6%AC-%ED%8C%8C%EC%9D%B4/>라즈베리 파이</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>관련 글</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/771435ba12d3f38c/><div class=article-image><img src=/p/771435ba12d3f38c/cover.c3ceb5778eca84c1cc8135a61f3185e6_hu_97e63247f67be0dd.png width=250 height=150 loading=lazy alt="Featured image of post 집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 10-1. Basic Auth로 내부용 서비스 보호하기" data-key=771435ba12d3f38c data-hash="md5-w861d47KhMHMgTWmHzGF5g=="></div><div class=article-details><h2 class=article-title>집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 10-1. Basic Auth로 내부용 서비스 보호하기</h2></div></a></article><article class=has-image><a href=/p/a4ded8cced5f045c/><div class=article-image><img src=/p/a4ded8cced5f045c/cover.e249f355823b533247a8c2171c459735_hu_7b891cd8eba98755.png width=250 height=150 loading=lazy alt="Featured image of post 집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 9. CloudNativePG로 쿠버네티스에서 데이터베이스 운용하기" data-key=a4ded8cced5f045c data-hash="md5-4knzVYI7UzJHqMIXHEWXNQ=="></div><div class=article-details><h2 class=article-title>집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 9. CloudNativePG로 쿠버네티스에서 데이터베이스 운용하기</h2></div></a></article><article class=has-image><a href=/p/a68cc3e1f5e8a95b/><div class=article-image><img src=/p/a68cc3e1f5e8a95b/cover.11f8d302af37944940bc140a8c4e3beb_hu_e7d7763323bd8039.png width=250 height=150 loading=lazy alt="Featured image of post 집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 8-1. Docker Registry UI 설정 및 Registry GC 사용법" data-key=a68cc3e1f5e8a95b data-hash="md5-EfjTAq83lElAvBQKjE476w=="></div><div class=article-details><h2 class=article-title>집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 8-1. Docker Registry UI 설정 및 Registry GC 사용법</h2></div></a></article><article class=has-image><a href=/p/be354d4b5f50a3ee/><div class=article-image><img src=/p/be354d4b5f50a3ee/cover.de948c7dfa7f535bd5760fe0c1280ffb_hu_a156967c2a81ca7d.png width=250 height=150 loading=lazy alt="Featured image of post 집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 8. Private Docker Registry 및 접속 ID/PW 설정하기" data-key=be354d4b5f50a3ee data-hash="md5-3pSMffp/U1vVdg/gwSgP+w=="></div><div class=article-details><h2 class=article-title>집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 8. Private Docker Registry 및 접속 ID/PW 설정하기</h2></div></a></article><article class=has-image><a href=/p/567b4c177bdb8401/><div class=article-image><img src=/p/567b4c177bdb8401/cover.4c40d5c76eae56e7f9e307557c37f03b_hu_6aa1a483823f788b.png width=250 height=150 loading=lazy alt="Featured image of post 집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 7-1. Web UI를 통해 간편하게 Sealed Secrets 만들기" data-key=567b4c177bdb8401 data-hash="md5-TEDVx26uVuf54wdVfDfwOw=="></div><div class=article-details><h2 class=article-title>집에서 라즈베리 파이 클러스터로 데이터센터 차리기 - 7-1. Web UI를 통해 간편하게 Sealed Secrets 만들기</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=LemonDouble/LemonDouble.github.io-comments data-repo-id=R_kgDOI0UkDA data-category=Comments data-category-id=DIC_kwDOI0UkDM4CcIeY data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script><footer class=site-footer><section class=copyright>&copy;
2022 -
2025 Lemon Blog</section><section class=powerby>LemonDouble<br><a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a>로 만듦<br><a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>의 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> 테마 사용 중</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>